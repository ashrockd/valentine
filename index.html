<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nishu, will you my valentine</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container4carousel">
        <div class="box">
            <span style="--i:1"><img src="img-600/img1.jpg"></span>
            <span style="--i:2"><img src="img-600/img2.jpg"></span>
            <span style="--i:3"><img src="img-600/img3.jpg"></span>
            <span style="--i:4"><img src="img-600/img4.jpg"></span>
            <span style="--i:5"><img src="img-600/img5.jpg"></span>
            <span style="--i:6"><img src="img-600/img6.jpg"></span>
            <span style="--i:7"><img src="img-600/img7.jpg"></span>
            <span style="--i:8"><img src="img-600/img8.jpg"></span>
            <span style="--i:9"><img src="img-600/img9.jpg"></span>
            <span style="--i:10"><img src="img-600/img10.jpg"></span>
            <span style="--i:11"><img src="img-600/img11.jpg"></span>
            <span style="--i:12"><img src="img-600/img12.png"></span>
            <span style="--i:13"><img src="img-600/img13.jpg"></span>
            <span style="--i:14"><img src="img-600/img14.jpg"></span>
            <span style="--i:15"><img src="img-600/img15.jpg"></span>
            <span style="--i:16"><img src="img-600/img16.jpg"></span>
            <span style="--i:17"><img src="img-600/img17.jpg"></span>
            <span style="--i:18"><img src="img-600/img18.jpg"></span>
            <span style="--i:19"><img src="img-600/img19.jpg"></span>
        </div>
        <div class="btns">
            <div role="button" class="btn prev"></div>
            <div role="button" class="btn next"></div>
        </div>
    </div>

    <div class="container">
        <h1 class="title">Will you be my <span class="nervous">Valentine</span></h1>
        <p class="subtitle">follow your heart</p>

        <div class="button-zone">
            <button id="anxiousBtn" class="anxious-button">
                <span class="button-text">No</span>
                <span class="thought-bubble"></span>
            </button>

            <button id="yesBtn" class="yesbutton">
                <span class="button-text">Yes</span>
                <span class="thought-bubble"></span>
            </button>

            <div id="panicMessage" class="panic-message"></div>
        </div>

        <div class="instructions">
            <p>ðŸ’¡ Try to hover over the button...</p>
        </div>
    </div>

    <!-- Fullscreen "Yes" reveal overlay (placeholder image). -->
    <div id="yesReveal" class="yes-reveal" aria-hidden="true">
        <div class="yes-reveal__flash"></div>
        <img
            id="yesRevealImg"
            class="yes-reveal__img"
            src="img/flash.jpg"
            alt="Yes!"
        >
    </div>

    <!-- Background music (autoplay requires a user gesture; script.js will start it on first interaction). -->
    <audio
        id="bgm"
        src="audio/bgm.mp3"
        preload="auto"
        loop
        crossorigin="anonymous"
    ></audio>

    <!-- Exposed low-pass filter settings (tweak live). -->
    <div class="audio-controls">
        <div class="audio-controls__row">
            <strong>Music Filter</strong>
            <span id="audioStatus" class="audio-controls__status">Click anywhere to start</span>
        </div>
        <label class="audio-controls__label">
            Cutoff (Hz)
            <input id="lpCutoff" type="range" min="80" max="20000" value="1200" step="10">
            <span id="lpCutoffVal" class="audio-controls__val">1200</span>
        </label>
        <label class="audio-controls__label">
            Resonance (Q)
            <input id="lpQ" type="range" min="0.1" max="20" value="0.8" step="0.1">
            <span id="lpQVal" class="audio-controls__val">0.8</span>
        </label>
        <label class="audio-controls__label">
            Volume
            <input id="bgmVol" type="range" min="0" max="1" value="0.35" step="0.01">
            <span id="bgmVolVal" class="audio-controls__val">0.35</span>
        </label>
    </div>

    <div id="bsod" class="bsod">
        <div class="sad-face">:(</div>
        <h2>Your PC ran into a problem and needs to restart. We're just collecting some error info, and then we'll restart for you.</h2>
        <div class="qr-code-zone">
            <div class="qr-placeholder">
                <canvas id="qrCanvas" role="img" aria-label="QR Code"></canvas>
            </div>
            <div class="info-text">
                For more information about this issue and possible fixes, visit https://www.windows.com/stopcode
                <br><br>
                If you call a support person, give them this info:
                <br>
                Stop code: CRITICAL_PROCESS_DIED
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function () {
      if (typeof QRious === "undefined") {
        console.error("QRious failed to load");
        return;
      }

      new QRious({
        element: document.getElementById("qrCanvas"),
        value: "https://shorturl.at/ZMHOg",
        size: 200,
        background: "#ffffff",
        foreground: "#000000"
      });
    });
    </script>

    <script>
        const prev = document.querySelector(".prev");
        const next = document.querySelector(".next");
        const box = document.querySelector(".box");
        const items = box ? Array.from(box.querySelectorAll("span")) : [];

        let degrees = 0;

        function layoutCarousel() {
            if (!box || items.length === 0) return;

            const count = items.length;
            const step = 360 / count;
            const boxSize = box.getBoundingClientRect().width || 200;
            const spacing = 12;
            const radius = Math.round((boxSize / 2 + spacing) / Math.tan(Math.PI / count));

            items.forEach((item, index) => {
                item.style.transform = `rotateY(${index * step}deg) translateZ(${radius}px)`;
            });

            box.style.transform = `perspective(1000px) rotateY(${degrees}deg)`;
            box.dataset.step = String(step);
        }

        layoutCarousel();
        window.addEventListener("resize", layoutCarousel);

        prev.addEventListener('click', function () {
            const step = parseFloat(box.dataset.step || "45");
            degrees += step;
            box.style.transform = `perspective(1000px) rotateY(${degrees}deg)`;
        });

        next.addEventListener('click', function () {
            const step = parseFloat(box.dataset.step || "45");
            degrees -= step;
            box.style.transform = `perspective(1000px) rotateY(${degrees}deg)`;
        });
    </script>

    <script src="script.js"></script>
</body>
</html>
